openapi: 3.0.0
info:
  title: RNA Seq API POC
  version: 0.9.4
tags:
  - name: projects
    description: High level collection of studies
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: studies
    description: Collection of associated uniformly processed RNA samples
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: expressions
    description: Feature level expression data
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: getVersions
    description: Returns database release versions
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: changelog
    description: Returns change log for a release version
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: files
    description: Returns files
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
  - name: continuous
    description: Coordinate range based signal data
    externalDocs:
      description: Find out more
      url: https://github.com/ga4gh-rnaseq/schema
paths:
  /projects:
    post:
      tags:
        - projects
      operationId: candig_rnaget.api.operations.post_project
      summary: Add a project to the database
      description: Creates and returns a new project record
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/project"
      responses:
        "201":
          description: New project created
          headers:
            Location:
              schema:
                type: string
                format: url
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/project"
        "400":
          description: Project provided in body does not pass schema validation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Authorisation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "405":
          description: Forbidden to overwrite project in post
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal error - project not created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /projects/search:
    get:
      tags:
        - projects
      summary: Search for projects matching filters
      description: Search for projects matching filters
      operationId: candig_rnaget.api.operations.search_projects
      parameters:
        - name: tags
          in: query
          description: Comma separated tag list to filter by
          explode: true
          schema:
            type: array
            items:
              type: string
        - name: version
          in: query
          description: version to return
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/project"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/project"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /projects/search/filters:
    get:
      tags:
        - projects
      summary: Returns filters for project searches
      description: Get filters for project searches
      operationId: candig_rnaget.api.operations.search_project_filters
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /projects/{projectId}:
    get:
      tags:
        - projects
      summary: Find project by ID
      description: Returns a single specified project
      operationId: candig_rnaget.api.operations.get_project_by_id
      parameters:
        - name: projectId
          in: path
          description: ID of project to return
          required: true
          schema:
            type: string
            format: uuid
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/project"
            application/json:
              schema:
                $ref: "#/components/schemas/project"
        "400":
          description: Invalid ID supplied
        "404":
          description: Project not found"
        "406":
          description: Requested formatting not supported
        "501":
          description: The specified request is not supported by the server
      security:
        - api_key: []
  /studies:
    post:
      tags:
        - studies
      operationId: candig_rnaget.api.operations.post_study
      summary: Add a study to the database
      description: Creates and returns a new study record
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/study"
      responses:
        "201":
          description: New study created
          headers:
            Location:
              schema:
                type: string
                format: url
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/study"
        "400":
          description: Project provided in body does not pass schema validation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Authorisation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "405":
          description: Forbidden to overwrite project in post
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal error - project not created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /studies/search:
    get:
      tags:
        - studies
      summary: Search for studies matching filters
      description: Search for studies matching filters
      operationId: candig_rnaget.api.operations.search_studies
      parameters:
        - name: tags
          in: query
          description: Comma separated tag list to filter by
          explode: true
          schema:
            type: array
            items:
              type: string
        - name: version
          in: query
          description: version to return
          schema:
            type: string
        - name: projectID
          in: query
          description: parent project identifier
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/study"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/study"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /studies/search/filters:
    get:
      tags:
        - studies
      summary: Returns filters for study searches
      description: Get filters for study searches
      operationId: candig_rnaget.api.operations.search_study_filters
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  "/studies/{studyId}":
    get:
      tags:
        - studies
      summary: Find study by ID
      description: Returns a single specified study
      operationId: candig_rnaget.api.operations.get_study_by_id
      parameters:
        - name: studyId
          in: path
          description: ID of study to return
          required: true
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/study"
            application/json:
              schema:
                $ref: "#/components/schemas/study"
        "400":
          description: Invalid ID supplied
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Study not found
      security:
        - api_key: []
  /expressions:
    post:
      tags:
        - expressions
      operationId: candig_rnaget.api.operations.post_expression
      summary: Create an expression database entry and map to quant file
      description: Creates and returns a new expression record
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/file"
      responses:
        "201":
          description: New expression created
          headers:
            Location:
              schema:
                type: string
                format: url
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/file"
        "400":
          description: Expression provided in body does not pass schema validation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Authorisation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "405":
          description: Forbidden to overwrite expression in post
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal error - expression not created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      tags:
        - expressions
      summary: Search for all expressions
      description: Search for all expressions
      operationId: candig_rnaget.api.operations.get_expressions
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /expressions/formats:
    get:
      tags:
        - expressions
      summary: Get output formats
      description: Returns a list of supported expression matrix formats
      operationId: candig_rnaget.api.operations.get_expression_formats
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        "404":
          description: Format list not found
        "406":
          description: Requested formatting not supported
        "501":
          description: The specified request is not supported by the server
  /expressions/search:
    get:
      tags:
        - expressions
      summary: Search for expressions matching filters
      description: Search for expressions matching filters
      operationId: candig_rnaget.api.operations.get_search_expressions
      parameters:
        - name: tags
          in: query
          description: Comma separated tag list to filter by
          explode: true
          schema:
            type: array
            items:
              type: string
        - name: sampleID
          in: query
          description: sampleID to match
          schema:
            type: string
        - name: projectID
          in: query
          description: project to filter by
          schema:
            type: string
        - name: studyID
          in: query
          description: study to filter by
          schema:
            type: string
        - name: version
          in: query
          description: version to filter by
          schema:
            type: string
        - name: featureIDList
          in: query
          description: return only values for listed feature IDs
          schema:
            type: array
            items:
              type: string
        - name: featureNameList
          in: query
          description: return only values for listed features
          schema:
            type: array
            items:
              type: string
        - name: minExpression
          in: query
          description: array of feature id, min threshold tuples
          schema:
            type: array
            items:
              type: string
        - name: maxExpression
          in: query
          description: array of feature id, max treshold tuples
          schema:
            type: array
            items:
              type: string
        - name: featureThresholdLabel
          in: query
          description: one of `id` or `name` reflecting what feature label type is being
            used when applying `maxExpression` or `minExpression`.  If blank,
            `name` will be assumed.
          schema:
            type: string
        - name: format
          in: query
          description: one of `h5` or `loom` or `json`
          required: true
          example: h5
          schema:
            type: string
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
    post:
      tags:
        - expressions
      summary: Post search for expressions matching filters
      description: Post search for expressions matching filters
      operationId: candig_rnaget.api.operations.post_search_expressions
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/expressionsearch"
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  /expressions/search/filters:
    get:
      tags:
        - expressions
      summary: Returns filters for project searches
      description: Get filters for project searches
      operationId: candig_rnaget.api.operations.search_expression_filters
      parameters:
        - name: type
          in: query
          description: one of `feature` or `sample` reflecting which axis to request
            filters for.  If blank, both will be returned
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/searchFilter"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  "/expressions/{expressionId}":
    get:
      tags:
        - expressions
      summary: Find expression data by ID
      description: Returns a single specified expression matrix
      operationId: candig_rnaget.api.operations.get_expression_by_id
      parameters:
        - name: expressionId
          in: path
          description: ID of expression to return
          required: true
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/file"
            application/json:
              schema:
                $ref: "#/components/schemas/file"
        "400":
          description: Invalid ID supplied
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Expression not found
      security:
        - api_key: []
  /changelog:
    post:
      tags:
        - changelog
      operationId: candig_rnaget.api.operations.post_change_log
      summary: Add a change log to the database
      description: Creates and returns a new change log record
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/changeLog"
      responses:
        "201":
          description: New change log created
          headers:
            Location:
              schema:
                type: string
                format: url
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/changeLog"
        "400":
          description: Change log provided in body does not pass schema validation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Authorisation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "405":
          description: Forbidden to overwrite change log in post
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal error - change log not created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /getVersions:
    get:
      tags:
        - getVersions
      summary: Get release versions of database
      operationId: candig_rnaget.api.operations.get_versions
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  type: string
                additionalProperties:
                  type: string
            application/json:
              schema:
                type: array
                items:
                  type: string
                additionalProperties:
                  type: string
        "400":
          description: Invalid tag value
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  "/changelog/{version}":
    get:
      tags:
        - changelog
      summary: Get change log for a specific release version
      description: Returns changes associated with specified database release version
      operationId: candig_rnaget.api.operations.get_change_log
      parameters:
        - name: version
          in: path
          description: release version
          required: true
          example: 0.9.4
          schema:
            type: string
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/changeLog"
            application/json:
              schema:
                $ref: "#/components/schemas/changeLog"
        "400":
          description: Invalid ID supplied
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Change log not found
      security:
        - api_key: []
  "/files/{fileID}":
    get:
      tags:
        - files
      summary: Get specific file
      description: Returns download URL for file
      operationId: candig_rnaget.api.operations.get_file
      parameters:
        - name: fileID
          in: path
          description: file ID
          required: true
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
          schema:
            type: string
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/file"
            application/json:
              schema:
                $ref: "#/components/schemas/file"
        "400":
          description: Invalid ID supplied
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: File not found
      security:
        - api_key: []
  /files/search:
    get:
      tags:
        - files
      summary: Search for files matching filters
      description: Search for files matching filters.  Returns download URL or manifest of
        download URLs for matching file(s)
      operationId: candig_rnaget.api.operations.search_files
      parameters:
        - name: tags
          in: query
          description: Comma separated tag list to filter by
          explode: true
          schema:
            type: array
            items:
              type: string
        - name: projectID
          in: query
          description: ProjectID to filter by
          schema:
            type: string
        - name: studyID
          in: query
          description: StudyID to filter by
          schema:
            type: string
        - name: fileType
          in: query
          description: File type to filter by
          schema:
            type: string
      responses:
        "200":
          description: Successful operation
          content:
            application/xml:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/file"
        "400":
          description: Error
        "403":
          description: Authorisation error
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/Error"
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - api_key: []
  "/continuous/{continuousId}":
    get:
      tags:
        - continuous
      summary: Retrieve continuous signal data by ID
      description: Returns a single specified signal matrix
      operationId: candig_rnaget.api.operations.get_continuous_by_id
      parameters:
        - name: continuousId
          in: path
          description: ID of continuous matrix to return
          required: true
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
          schema:
            type: string
      responses:
        "501":
          description: The specified request is not supported by the server
  /continuous/formats:
    get:
      tags:
        - continuous
      summary: Get output formats
      description: Returns a list of supported continuous matrix formats
      operationId: candig_rnaget.api.operations.get_continuous_formats
      responses:
        "501":
          description: The specified request is not supported by the server
  /continuous/search:
    get:
      tags:
        - continuous
      summary: Search for continuous data matching filters
      description: Search for continuous data matching filters
      operationId: candig_rnaget.api.operations.search_continuous
      parameters:
        - name: format
          in: query
          description: Data format to return
          required: true
          example: loom
          schema:
            type: string
        - name: tags
          in: query
          description: Comma separated tag list to filter by
          style: form
          explode: false
          schema:
            type: array
            items:
              type: string
        - name: sampleIDList
          in: query
          description: comma separated list of sampleIDs to match
          style: form
          explode: false
          schema:
            type: array
            items:
              type: string
        - name: projectID
          in: query
          description: project to filter by
          schema:
            type: string
        - name: studyID
          in: query
          description: study to filter by
          schema:
            type: string
        - name: version
          in: query
          description: version to filter by
          schema:
            type: string
        - name: chr
          in: query
          description: The refererence to which start and end apply in the form chr? where
            ? is the specific ID of the chromosome (ex. chr1, chrX).
          schema:
            type: string
        - name: start
          in: query
          description: The start position of the range on the sequence, 0-based, inclusive.
          schema:
            type: integer
        - name: end
          in: query
          description: The end position of the range on the sequence, 0-based, exclusive.
          schema:
            type: integer
      responses:
        "501":
          description: The specified request is not supported by the server
servers:
  - url: /rnaget
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: Authorization
      in: header
      x-apikeyInfoFunc: candig_rnaget.auth.auth_key
  schemas:
    Error:
      type: object
      required:
        - message
        - code
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
    project:
      type: object
      properties:
        id:
          type: string
          format: uuid
        version:
          type: string
        tags:
          type: array
          items:
            type: string
        name:
          type: string
          example: test_project
        description:
          type: string
        created:
          type: string
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: project
    study:
      type: object
      properties:
        id:
          type: string
          format: uuid
        version:
          type: string
        tags:
          type: array
          items:
            type: string
        name:
          type: string
        description:
          type: string
        parentProjectID:
          type: string
          format: uuid
        patientList:
          type: array
          items:
            type: string
        sampleList:
          type: array
          items:
            type: string
        created:
          type: string
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: study
    expressionsearch:
      type: object
      description: Expression search query object
      properties:
        version:
          type: string
        tags:
          type: array
          items:
            type: string
        sampleID:
          type: string
        projectID:
          type: string
          format: uuid
          example: be2ba51c-8dfe-4619-b832-31c4a087a589
        studyID:
          type: string
          format: uuid
        featureIDList:
          type: array
          items:
            type: string
        featureNameList:
          type: array
          items:
            type: string
        minExpression:
          type: array
          items:
            type: object
        maxExpression:
          type: array
          items:
            type: object
        format:
          type: string
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: expressionsearch
    searchFilter:
      type: object
      description: parameter name to use for filter when searching
      properties:
        fieldType:
          type: string
        filter:
          type: string
        description:
          type: string
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: filters
    changeLog:
      type: object
      description: list of changes to the database associated with a version update
      properties:
        version:
          type: string
          example: 0.9.4
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: changeLog
    file:
      type: object
      description: URL and type for raw data and analysis pipeline files
      properties:
        id:
          type: string
        version:
          type: string
        tags:
          type: array
          items:
            type: string
        fileType:
          type: string
        studyID:
          type: string
          format: uuid
        URL:
          type: string
        units:
          type: string
        created:
          type: string
      externalDocs:
        description: Find out more
        url: https://github.com/ga4gh-rnaseq/schema
      xml:
        name: file
